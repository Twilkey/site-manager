{"version":3,"file":"static/js/741.0608b272.chunk.js","mappings":"gOA8EA,UA1EkB,SAACA,GACf,IAAMC,GAAcC,EAAAA,EAAAA,MACpB,GAAkCC,EAAAA,EAAAA,UAAS,IAAG,eAAvCC,EAAS,KAAEC,EAAY,KAC9B,GAAwBF,EAAAA,EAAAA,UAAS,IAAG,eAA7BG,EAAI,KAAEC,EAAO,KACdC,GAAmBC,EAAAA,EAAAA,SAAO,GAgChC,OA9BAC,EAAAA,EAAAA,YAAU,WACN,IAAMC,EAAQC,mBAAmBX,EAAYU,OACvCE,EAAO,yCAAG,mGACNC,MAAM,UAAGC,kCAAiC,KAAM,IAAIC,gBAAgB,CACtEC,YAAaC,OAAOC,SAASC,SAC7BC,OAAQ,aACRC,OAAQ,yCACRC,MAAO,2JACPC,MAAO,yBACPC,OAAO,cAAD,OAAgBd,MAEzBe,MAAK,SAACC,GACH,OAAOA,EAASC,MACpB,IACCF,MAAK,SAACG,GACHtB,EAAQsB,EACZ,IACA,SAACC,GACGC,QAAQC,IAAIF,GACZG,EAAAA,EAAAA,MAAa,SAAC,IAAO,CAACC,UAAQ,EAACC,KAAK,QAAO,SAAEL,EAAMM,UAAoB,CAAEC,SAAU,KACvF,IAAG,KAAD,sCACL,kBAnBY,oCAqBmB,IAA7B7B,EAAiB8B,UAChBjC,EAAaM,GACbE,IACAL,EAAiB8B,SAAU,EAEnC,GAAG,CAACrC,EAAYU,SAGZ,iCACI,gBAAK4B,UAAU,aAAY,UACvB,wBAAKnC,MAERE,IACG,iBAAKiC,UAAU,aAAY,WACvB,iBAAKA,UAAU,kBAAiB,WAC5B,gBAAKA,UAAU,qCAAoC,SAAC,UACpD,gBAAKA,UAAU,qCAAoC,SAAC,UACpD,gBAAKA,UAAU,qCAAoC,SAAC,cACpD,gBAAKA,UAAU,qCAAoC,SAAC,WACpD,gBAAKA,UAAU,qCAAoC,SAAC,cACpD,gBAAKA,UAAU,qCAAoC,SAAC,eAEvDC,OAAOC,QAAQnC,GAAMoC,KAAI,SAACC,EAAMC,GAC7B,IAAIC,EAAWF,EAAK,GAChBG,EAAWC,KAAKC,MAAMH,EAASI,OAAOC,MAAK,SAAAC,GAAC,OAAIA,EAAEC,aAAehD,CAAS,IAE9E,OACI,gBAAKmC,UAAU,wBAAuB,UAClC,iBAAKA,UAAU,uBAAsB,WACjC,gBAAKA,UAAU,qCAAoC,UAAC,SAAC,KAAI,CAACc,GAAE,gBAAWR,EAASS,IAAK,SAAET,EAASU,WAChG,gBAAKhB,UAAU,oBAAmB,SAAEO,EAASU,gBAC7C,gBAAKjB,UAAU,oBAAmB,SAAEO,EAASW,cAC7C,gBAAKlB,UAAU,oBAAmB,SAAEO,EAASY,MAAMC,KAAK,SACxD,gBAAKpB,UAAU,oBAAmB,UAAC,cAAGqB,KAAMf,EAASgB,IAAKC,OAAO,SAASC,IAAI,aAAY,SAAC,aAC3F,gBAAKxB,UAAU,oBAAmB,UAAC,cAAGqB,KAAMf,EAASmB,SAAUF,OAAO,SAASC,IAAI,aAAY,SAAC,gBAP5DnB,EAWpD,SAKpB,C","sources":["pages/SiteUsers.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { Link, useParams } from \"react-router-dom\";\r\nimport { Message, toaster } from 'rsuite';\r\n\r\nconst SiteUsers = (props) => {\r\n    const routeParams = useParams();\r\n    const [useremail, setUserEmail] = useState('');\r\n    const [data, setData] = useState([]);\r\n    const fetchingComplete = useRef(false);\r\n\r\n    useEffect(() => {\r\n        const email = decodeURIComponent(routeParams.email);\r\n        const getData = async () => {\r\n            await fetch(`${process.env.REACT_APP_BACKEND_URL}?` + new URLSearchParams({\r\n                enviornment: window.location.hostname,\r\n                action: 'get_custom',\r\n                fields: 'sites.*, domains.domain AS domain_name',\r\n                table: 'sites LEFT JOIN domains on sites.domain = domains.id, JSON_TABLE(sites.users, \"$[*]\" COLUMNS(user_email VARCHAR(100) PATH \"$.user_email\")) as user_email',\r\n                where: 'user_email=:user_email',\r\n                params: `user_email:${email}`\r\n            }))\r\n            .then((response) => {\r\n                return response.json();\r\n            })\r\n            .then((result) => {\r\n                setData(result);\r\n            },\r\n            (error) => {\r\n                console.log(error)\r\n                toaster.push(<Message showIcon type=\"error\">{error.message}</Message>, { duration: 3000 });\r\n            });\r\n        }\r\n\r\n        if(fetchingComplete.current === false){\r\n            setUserEmail(email);\r\n            getData();\r\n            fetchingComplete.current = true;\r\n        }\r\n    }, [routeParams.email]);\r\n\r\n    return (\r\n        <>\r\n            <div className='page-title'>\r\n                <h1>{useremail}</h1>\r\n            </div>\r\n            {data && \r\n                <div className='page-table'>\r\n                    <div className='page-table-head'>\r\n                        <div className='page-table-column page-table-label'>Site</div>\r\n                        <div className='page-table-column page-table-label'>Name</div>\r\n                        <div className='page-table-column page-table-label'>Username</div>\r\n                        <div className='page-table-column page-table-label'>Roles</div>\r\n                        <div className='page-table-column page-table-label'>Frontend</div>\r\n                        <div className='page-table-column page-table-label'>Backend</div>\r\n                    </div>\r\n                    {Object.entries(data).map((item, index) => {\r\n                        let itemData = item[1];\r\n                        let userdata = JSON.parse(itemData.users).find(u => u.user_email === useremail);\r\n\r\n                        return (\r\n                            <div className='page-table-row-outter' key={index}>\r\n                                <div className='page-table-row-inner'>\r\n                                    <div className='page-table-column page-table-label'><Link to={`/site/${itemData.id}`}>{itemData.label}</Link></div>\r\n                                    <div className='page-table-column'>{userdata.display_name}</div>\r\n                                    <div className='page-table-column'>{userdata.user_login}</div>\r\n                                    <div className='page-table-column'>{userdata.roles.join(', ')}</div>\r\n                                    <div className='page-table-column'><a href={itemData.url} target=\"_blank\" rel=\"noreferrer\">Visit</a></div>\r\n                                    <div className='page-table-column'><a href={itemData.adminurl} target=\"_blank\" rel=\"noreferrer\">Visit</a></div>\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    })}\r\n                </div>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default SiteUsers;"],"names":["props","routeParams","useParams","useState","useremail","setUserEmail","data","setData","fetchingComplete","useRef","useEffect","email","decodeURIComponent","getData","fetch","process","URLSearchParams","enviornment","window","location","hostname","action","fields","table","where","params","then","response","json","result","error","console","log","toaster","showIcon","type","message","duration","current","className","Object","entries","map","item","index","itemData","userdata","JSON","parse","users","find","u","user_email","to","id","label","display_name","user_login","roles","join","href","url","target","rel","adminurl"],"sourceRoot":""}